# AstrBot 光遇插件 (astrbot_plugin_sky)

🌟 光遇(Sky: Children of the Light)游戏助手插件，支持自然语言交互查询游戏信息、光遇ID绑定、服务器状态、定时推送提醒等功能。

## ✨ 功能特性

### 📋 信息查询
- **每日任务** - 获取今日每日任务图片
- **季节蜡烛** - 获取季节蜡烛位置图片
- **大蜡烛** - 获取大蜡烛位置图片
- **免费魔法** - 获取今日免费魔法图片
- **季节进度** - 查看当前季节进度和剩余时间
- **碎石信息** - 查看今日碎石位置和类型
- **复刻先祖** - 查看当前复刻先祖信息
- **献祭信息** - 查看献祭刷新时间和奖励
- **老奶奶时间** - 查看老奶奶用餐时间表
- **光遇状态** - 查看光遇服务器排队状态

### 🪽 光翼查询
- **光遇ID绑定** - 绑定游戏内短ID
- **光翼查询** - 查询指定ID的光翼收集情况
- **光翼统计** - 查看全图光翼统计

### ⏰ 定时推送
- 每日任务自动推送
- 老奶奶用餐提醒
- 献祭刷新提醒
- 碎石位置提醒

### 🎛️ WebUI配置
通过AstrBot的WebUI管理面板配置：
- LLM Provider选择
- 推送功能开关
- 推送时间设置
- 推送群组列表

## 📦 安装

### 方法一：手动安装
```bash
# 解压到AstrBot插件目录
cd AstrBot/data/plugins
tar -xzvf astrbot_plugin_sky_v7.tar.gz
# 重启AstrBot
```

### 方法二：通过插件市场（后续可发布）

## ⚙️ 配置

在AstrBot WebUI管理面板中，进入「插件配置」→「astrbot_plugin_sky」进行配置：

| 配置项 | 说明 | 默认值 |
|--------|------|--------|
| LLM Provider ID | 选择用于自然语言交互的LLM提供商 | 使用默认 |
| 启用每日任务推送 | 是否每天自动推送光遇每日任务 | true |
| 每日任务推送时间 | 每日任务自动推送的时间 (HH:MM) | 08:00 |
| 推送群组列表 | 需要接收定时推送的群组ID列表 | [] |
| 启用老奶奶干饭提醒 | 是否在老奶奶用餐时间发送提醒 | true |
| 启用献祭刷新提醒 | 是否在献祭刷新时发送提醒 | true |
| 启用碎石提醒 | 是否提醒每日碎石位置 | true |
| API请求超时时间 | 请求光遇数据API的超时时间（秒） | 10 |
| 数据缓存时间 | 光遇数据的缓存时间（分钟） | 30 |

## 📝 使用说明

### 信息查询命令

```
每日任务          - 获取今日每日任务图片
季节蜡烛          - 获取季节蜡烛位置图片
大蜡烛            - 获取大蜡烛位置图片
免费魔法          - 获取今日免费魔法图片
季节进度          - 查看当前季节进度
碎石信息          - 查看今日碎石信息
复刻先祖          - 查看当前复刻先祖
献祭信息          - 查看献祭相关信息
老奶奶时间        - 查看老奶奶用餐时间
光遇状态          - 查看光遇服务器排队状态
```

### 光翼查询命令

```
光遇绑定 <ID>     - 绑定光遇ID（游戏内短ID）
光遇切换 <序号>   - 切换当前ID
光遇删除 <序号>   - 删除绑定的ID
光遇ID列表        - 查看所有绑定的ID
光翼查询          - 查询当前ID的光翼
光翼查询 <ID>     - 查询指定ID的光翼
光翼统计          - 查看全图光翼统计
```

### 示例

**绑定光遇ID：**
```
用户: 光遇绑定 123456789
Bot: ✅ 绑定成功！当前ID: 123456789

💡 使用「光翼查询」查询该ID的光翼信息
```

**查询光翼：**
```
用户: 光翼查询
Bot: 🪽 光翼查询结果
📍 ID: 123456789
🕐 数据时间: 2025-07-25 12:00:00

📊 光翼统计:
   总数: 118
   已收集: 105
   未收集: 13

📍 各地图光翼:
   晨岛: 5个
   云野: 8个
   ...
```

**查询服务器状态：**
```
用户: 光遇状态
Bot: ✅ 当前光遇服务器畅通，无需排队

或

Bot: ⏳ 当前光遇服务器排队中
👥 排队人数: 1234位
⏰ 预计等待时间: 5分30秒
```

### 自然语言交互

你可以直接用自然语言与机器人对话：

```
用户: 今天光遇有什么任务？
Bot: [自动调用工具返回每日任务图片]

用户: 季节蜡烛在哪里？
Bot: [自动调用工具返回季节蜡烛图片]

用户: 光遇服务器状态怎么样？
Bot: ✅ 当前光遇服务器畅通，无需排队
```

## 🔧 开发计划

- [x] 信息查询功能
- [x] 光遇ID绑定
- [x] 光翼查询
- [x] 服务器状态查询
- [x] 定时推送
- [x] WebUI配置
- [x] 自然语言交互（LLM工具）
- [ ] 光遇图鉴查询
- [ ] 先祖位置查询

## 🤝 贡献

欢迎提交Issue和Pull Request！

## 📄 许可证

本项目采用 [MIT License](LICENSE) 开源许可证。

## 🙏 致谢

- 感谢 [AstrBot](https://github.com/Soulter/AstrBot) 提供的优秀框架
- 光遇数据API由 [Tlon-Sky](https://gitee.com/Tloml-Starry/Tlon-Sky) 提供

## 📞 联系方式

如有问题或建议，欢迎：
- 提交 [GitHub Issue](https://github.com/AstrBot-Devs/astrbot_plugin_sky/issues)
- 加入 AstrBot 官方交流群

---

⭐ 如果这个项目对你有帮助，请给个Star支持一下吧！
